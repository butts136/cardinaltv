{% extends "diaporama_base.html" %}

{% block title %}M√©t√©o ¬∑ Cardinal TV{% endblock %}

{% block page_title %}M√©t√©o{% endblock %}
{% block page_subtitle %}
  <p class="page-subtitle">Configurez l'affichage des conditions m√©t√©orologiques et pr√©visions.</p>
{% endblock %}
{% block header_actions %}
  <a href="{{ url_for('main.slideshow_overview') }}" class="secondary-button">Vue g√©n√©rale</a>
{% endblock %}

{% block content %}
  <section class="card weather-section" id="weather-section">
    <div class="section-header">
      <div>
        <h2>Diapositive M√©t√©o üå§Ô∏è</h2>
        <p class="playlist-subtitle">Affichez les conditions m√©t√©o actuelles et les pr√©visions.</p>
      </div>
      <div class="custom-toggle-control">
        <label class="visibility-toggle">
          <span class="visibility-toggle-label visibility-toggle-label-on">Activ√©e</span>
          <div class="visibility-toggle-switch">
            <input id="weather-enabled" class="visibility-toggle-checkbox" type="checkbox" aria-label="Activer la diapo" />
            <span class="visibility-toggle-slider"></span>
          </div>
          <span class="visibility-toggle-label visibility-toggle-label-off">D√©sactiv√©e</span>
        </label>
      </div>
    </div>

    <div class="section-content">
      <div class="form-row dual">
        <div>
          <label for="weather-duration">Dur√©e (secondes)</label>
          <input type="number" id="weather-duration" min="5" max="120" step="1" value="15" />
          <p class="field-hint">Temps d'affichage de la diapositive.</p>
        </div>
        <div>
          <label for="weather-location-name">Ville</label>
          <input type="text" id="weather-location-name" value="Qu√©bec" />
          <div id="weather-city-suggestions" class="widget-weather-suggestions" aria-live="polite"></div>
        </div>
        <div>
          <label for="weather-latitude">Latitude</label>
          <input type="number" id="weather-latitude" step="0.0001" value="46.8139" />
        </div>
        <div>
          <label for="weather-longitude">Longitude</label>
          <input type="number" id="weather-longitude" step="0.0001" value="-71.2080" />
        </div>
      </div>
      
      <div class="birthday-preview-actions">
        <button type="button" class="primary-button" id="weather-save">Enregistrer</button>
        <span id="weather-status" class="upload-feedback" aria-live="polite"></span>
      </div>
    </div>
  </section>

  <section class="card weather-display-section" id="weather-display-section">
    <div class="section-header">
      <div>
        <h2>√âl√©ments √† afficher</h2>
        <p class="playlist-subtitle">Choisissez les informations m√©t√©o √† montrer.</p>
      </div>
    </div>

    <div class="section-content">
      <div class="form-row dual">
        <div>
          <label class="live-editor-date-toggle" for="show-current">
            <input id="show-current" type="checkbox" checked />
            Temp√©rature actuelle
          </label>
        </div>
        <div>
          <label class="live-editor-date-toggle" for="show-feels-like">
            <input id="show-feels-like" type="checkbox" checked />
            Temp√©rature ressentie
          </label>
        </div>
        <div>
          <label class="live-editor-date-toggle" for="show-humidity">
            <input id="show-humidity" type="checkbox" checked />
            Humidit√©
          </label>
        </div>
        <div>
          <label class="live-editor-date-toggle" for="show-wind">
            <input id="show-wind" type="checkbox" checked />
            Vent
          </label>
        </div>
        <div>
          <label class="live-editor-date-toggle" for="show-forecast">
            <input id="show-forecast" type="checkbox" checked />
            Pr√©visions
          </label>
        </div>
        <div>
          <label for="forecast-days">Jours de pr√©vision</label>
          <input type="number" id="forecast-days" min="1" max="7" step="1" value="5" />
        </div>
      </div>
      <div class="form-row dual">
        <div>
          <label for="weather-icon-size">Taille ic√¥ne (px)</label>
          <input type="number" id="weather-icon-size" min="40" max="240" step="2" value="210" />
        </div>
        <div>
          <label for="weather-temp-size">Taille temp√©rature (px)</label>
          <input type="number" id="weather-temp-size" min="24" max="200" step="2" value="150" />
        </div>
        <div>
          <label for="weather-condition-size">Taille condition (px)</label>
          <input type="number" id="weather-condition-size" min="14" max="72" step="1" value="58" />
        </div>
        <div>
          <label for="weather-detail-label-size">Taille labels d√©tails (px)</label>
          <input type="number" id="weather-detail-label-size" min="10" max="36" step="1" value="30" />
        </div>
        <div>
          <label for="weather-detail-value-size">Taille valeurs d√©tails (px)</label>
          <input type="number" id="weather-detail-value-size" min="12" max="48" step="1" value="44" />
        </div>
        <div>
          <label for="weather-forecast-icon-size">Taille ic√¥ne pr√©visions (px)</label>
          <input type="number" id="weather-forecast-icon-size" min="16" max="72" step="1" value="70" />
        </div>
        <div>
          <label for="weather-forecast-text-size">Taille texte pr√©visions (px)</label>
          <input type="number" id="weather-forecast-text-size" min="10" max="36" step="1" value="34" />
        </div>
        <div>
          <label for="weather-forecast-min-width">Largeur mini carte pr√©vision (px)</label>
          <input type="number" id="weather-forecast-min-width" min="60" max="200" step="5" value="200" />
        </div>
      </div>
      <div class="form-row">
        <label for="weather-card-opacity">Opacit√© de la carte</label>
        <div class="range-input">
          <input type="range" id="weather-card-opacity" min="20" max="100" step="1" value="100" />
          <span class="range-value" id="weather-card-opacity-value">100%</span>
        </div>
      </div>
    </div>
  </section>

  <section class="card weather-preview-section" id="weather-preview-section">
    <div class="section-header">
      <div>
        <h2>Aper√ßu m√©t√©o actuelle</h2>
        <p class="playlist-subtitle">Donn√©es m√©t√©o en temps r√©el.</p>
      </div>
      <button type="button" class="secondary-button" id="refresh-weather-btn">Rafra√Æchir</button>
    </div>

    <div class="section-content">
      <div id="weather-preview" class="weather-layout">
        <div class="weather-card weather-card-combined">
          <div class="weather-location" id="weather-location">Qu√©bec</div>
          <div class="weather-current">
            <div class="weather-icon" id="weather-icon">üå§Ô∏è</div>
            <div class="weather-temp" id="weather-temp">--¬∞C</div>
            <div class="weather-condition" id="weather-condition">Chargement...</div>
          </div>
          <div class="weather-details">
            <div class="weather-detail">
              <span class="detail-label">Jour</span>
              <span class="detail-value" id="weather-temp-day">--¬∞C</span>
            </div>
            <div class="weather-detail">
              <span class="detail-label">Soir</span>
              <span class="detail-value" id="weather-temp-evening">--¬∞C</span>
            </div>
            <div class="weather-detail">
              <span class="detail-label">Nuit</span>
              <span class="detail-value" id="weather-temp-night">--¬∞C</span>
            </div>
            <div class="weather-detail">
              <span class="detail-label">Max</span>
              <span class="detail-value" id="weather-temp-max">--¬∞C</span>
            </div>
            <div class="weather-detail">
              <span class="detail-label">Min</span>
              <span class="detail-value" id="weather-temp-min">--¬∞C</span>
            </div>
            <div class="weather-detail">
              <span class="detail-label">Humidit√©</span>
              <span class="detail-value" id="weather-humidity">--%</span>
            </div>
            <div class="weather-detail">
              <span class="detail-label">Vent</span>
              <span class="detail-value" id="weather-wind">-- km/h</span>
            </div>
          </div>
          <div class="weather-forecast-row" id="weather-forecast">
            <!-- Pr√©visions charg√©es dynamiquement -->
          </div>
        </div>
      </div>
    </div>
  </section>


  <section class="card weather-backgrounds-section" id="weather-backgrounds-section">
    <div class="section-header">
      <div>
        <h2>Arri√®re-plans par condition</h2>
        <p class="playlist-subtitle">D√©finissez un arri√®re-plan diff√©rent pour chaque type de temps.</p>
      </div>
    </div>

    <div class="section-content">
      <div class="weather-bg-grid">
        <div class="weather-bg-item" data-condition="sunny">
          <div class="weather-bg-preview" id="bg-sunny-preview">
            <span class="weather-bg-icon">‚òÄÔ∏è</span>
            <span class="weather-bg-label">Ensoleill√©</span>
          </div>
          <input type="file" id="bg-sunny-input" class="visually-hidden" accept="image/*,video/*" />
          <label for="bg-sunny-input" class="secondary-button">Choisir</label>
        </div>
        <div class="weather-bg-item" data-condition="cloudy">
          <div class="weather-bg-preview" id="bg-cloudy-preview">
            <span class="weather-bg-icon">‚òÅÔ∏è</span>
            <span class="weather-bg-label">Nuageux</span>
          </div>
          <input type="file" id="bg-cloudy-input" class="visually-hidden" accept="image/*,video/*" />
          <label for="bg-cloudy-input" class="secondary-button">Choisir</label>
        </div>
        <div class="weather-bg-item" data-condition="rainy">
          <div class="weather-bg-preview" id="bg-rainy-preview">
            <span class="weather-bg-icon">üåßÔ∏è</span>
            <span class="weather-bg-label">Pluvieux</span>
          </div>
          <input type="file" id="bg-rainy-input" class="visually-hidden" accept="image/*,video/*" />
          <label for="bg-rainy-input" class="secondary-button">Choisir</label>
        </div>
        <div class="weather-bg-item" data-condition="snowy">
          <div class="weather-bg-preview" id="bg-snowy-preview">
            <span class="weather-bg-icon">‚ùÑÔ∏è</span>
            <span class="weather-bg-label">Neigeux</span>
          </div>
          <input type="file" id="bg-snowy-input" class="visually-hidden" accept="image/*,video/*" />
          <label for="bg-snowy-input" class="secondary-button">Choisir</label>
        </div>
        <div class="weather-bg-item" data-condition="stormy">
          <div class="weather-bg-preview" id="bg-stormy-preview">
            <span class="weather-bg-icon">‚õàÔ∏è</span>
            <span class="weather-bg-label">Orageux</span>
          </div>
          <input type="file" id="bg-stormy-input" class="visually-hidden" accept="image/*,video/*" />
          <label for="bg-stormy-input" class="secondary-button">Choisir</label>
        </div>
        <div class="weather-bg-item" data-condition="foggy">
          <div class="weather-bg-preview" id="bg-foggy-preview">
            <span class="weather-bg-icon">üå´Ô∏è</span>
            <span class="weather-bg-label">Brumeux</span>
          </div>
          <input type="file" id="bg-foggy-input" class="visually-hidden" accept="image/*,video/*" />
          <label for="bg-foggy-input" class="secondary-button">Choisir</label>
        </div>
        <div class="weather-bg-item" data-condition="windy">
          <div class="weather-bg-preview" id="bg-windy-preview">
            <span class="weather-bg-icon">üí®</span>
            <span class="weather-bg-label">Venteux</span>
          </div>
          <input type="file" id="bg-windy-input" class="visually-hidden" accept="image/*,video/*" />
          <label for="bg-windy-input" class="secondary-button">Choisir</label>
        </div>
        <div class="weather-bg-item" data-condition="default">
          <div class="weather-bg-preview" id="bg-default-preview">
            <span class="weather-bg-icon">üå§Ô∏è</span>
            <span class="weather-bg-label">Par d√©faut</span>
          </div>
          <input type="file" id="bg-default-input" class="visually-hidden" accept="image/*,video/*" />
          <label for="bg-default-input" class="secondary-button">Choisir</label>
        </div>
      </div>
    </div>
  </section>

  <section class="card weather-seasonal-section" id="weather-seasonal-section">
    <div class="section-header">
      <div>
        <h2>Arri√®re-plans saisonniers</h2>
        <p class="playlist-subtitle">Optionnellement, utilisez des arri√®re-plans diff√©rents selon la saison.</p>
      </div>
      <div class="custom-toggle-control">
        <label class="visibility-toggle">
          <span class="visibility-toggle-label visibility-toggle-label-on">Activ√©s</span>
          <div class="visibility-toggle-switch">
            <input id="use-seasonal-bg" class="visibility-toggle-checkbox" type="checkbox" />
            <span class="visibility-toggle-slider"></span>
          </div>
          <span class="visibility-toggle-label visibility-toggle-label-off">D√©sactiv√©s</span>
        </label>
      </div>
    </div>

    <div class="section-content">
      <div class="weather-bg-grid seasonal">
        <div class="weather-bg-item" data-condition="spring">
          <div class="weather-bg-preview" id="bg-spring-preview">
            <span class="weather-bg-icon">üå∏</span>
            <span class="weather-bg-label">Printemps</span>
          </div>
          <input type="file" id="bg-spring-input" class="visually-hidden" accept="image/*,video/*" />
          <label for="bg-spring-input" class="secondary-button">Choisir</label>
        </div>
        <div class="weather-bg-item" data-condition="summer">
          <div class="weather-bg-preview" id="bg-summer-preview">
            <span class="weather-bg-icon">üåª</span>
            <span class="weather-bg-label">√ât√©</span>
          </div>
          <input type="file" id="bg-summer-input" class="visually-hidden" accept="image/*,video/*" />
          <label for="bg-summer-input" class="secondary-button">Choisir</label>
        </div>
        <div class="weather-bg-item" data-condition="autumn">
          <div class="weather-bg-preview" id="bg-autumn-preview">
            <span class="weather-bg-icon">üçÇ</span>
            <span class="weather-bg-label">Automne</span>
          </div>
          <input type="file" id="bg-autumn-input" class="visually-hidden" accept="image/*,video/*" />
          <label for="bg-autumn-input" class="secondary-button">Choisir</label>
        </div>
        <div class="weather-bg-item" data-condition="winter">
          <div class="weather-bg-preview" id="bg-winter-preview">
            <span class="weather-bg-icon">‚õÑ</span>
            <span class="weather-bg-label">Hiver</span>
          </div>
          <input type="file" id="bg-winter-input" class="visually-hidden" accept="image/*,video/*" />
          <label for="bg-winter-input" class="secondary-button">Choisir</label>
        </div>
      </div>
    </div>
  </section>

{% endblock %}

{% block scripts %}
  {{ super() }}
  <script src="{{ url_for('static', filename='js/weather_editor.js') }}"></script>
{% endblock %}
